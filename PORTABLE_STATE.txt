# PORTABLE_STATE.txt
Single source of truth for resuming this project on another machine.

[Required folders/files]
1) Code/config
- configs/paths.yaml
- configs/train.yaml
- configs/gen.yaml
- .env (or recreate from .env.example)

2) Data for training resume
- data/raw/inbox/*.txt (or organized raw source)
- data/processed/{train.bin,val.bin,tokenizer.json,stats.json,messages.jsonl,preview.json}
- checkpoints/<run_name>/latest.pt (and optionally best.pt, snapshots/*)

3) Data for inference-only
- artifacts/model_latest.pt OR artifacts/model_latest.enc
- artifacts/model_info.json
- .env with CHATBOT_PASSWORD (+ CHATBOT_MODEL_KEY if using .enc)

[Environment variables]
- CHATBOT_PASSWORD=...             # required for reply/chat/bridge gate
- CHATBOT_MODEL_KEY=...            # required when loading encrypted model (.enc)
- CHATBOT_DEFAULT_USER=...         # optional named-mode fallback
- CHATBOT_DEFAULT_BOT=...          # optional named-mode fallback

[One-line resume commands]
1) Full training resume:
python -m chatbot.ops train

2) Long-run training:
python -m chatbot.ops train --max_steps 2147483647

3) Inference check:
python -m chatbot.ops reply "테스트"

[Pipeline commands]
- Archive old outputs: python -m chatbot.ops archive --dry && python -m chatbot.ops archive
- Organize raw txt:    python -m chatbot.ops organize
- Preprocess:          python -m chatbot.ops preprocess
- Train/resume:        python -m chatbot.ops train
- Chat:                python -m chatbot.ops chat
- Bridge dry-run:      python -m chatbot.ops bridge --dry

[Model publish]
- Plain:      python -m chatbot.ops publish
- Encrypted:  python -m chatbot.ops publish --encrypt
Output is always kept as one latest artifact in `artifacts/`.

[Important notes]
- Default preprocess mode is context-aware (`context_windows`) and uses multi-turn context.
- If model quality is poor, retune `configs/paths.yaml > processed.preprocess` and rerun preprocess+train.
- Security gate is minimum protection only; code changes can bypass it.
- Keep sensitive data out of git (`data/raw`, `data/processed`, `checkpoints`).
